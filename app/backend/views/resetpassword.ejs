<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles/resetpassword.css">
    <title>Document</title>
</head>

<body>
    <div class="mainDiv">
        <div class="cardStyle">
            <form action="#" method="post" name="signupForm" id="signupForm">
                <h2 class="formTitle">
                    Change Password
                </h2>
                <div class="inputDiv">
                    <label class="inputLabel" for="email">Email</label>
                    <input type="email" id="email" name="email" required placeholder="Enter your mail ID">
                </div>
                <div class="inputDiv">
                    <label class="inputLabel" for="password">New Password</label>
                    <input type="password" id="password" name="password" required placeholder="Enter new Password">
                </div>
                <div class="inputDiv">
                    <label class="inputLabel" for="confirmPassword">Confirm Password</label>
                    <input type="password" id="confirmPassword" name="confirmPassword" placeholder="Confirm Password">
                </div>
                <div class="buttonWrapper">
                    <button type="button" id="submitButton" onclick="handleSubmit()" class="submitButton pure-button pure-button-primary">
                        <span>Confirm</span>
                        <span id="loader"></span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        async function handleSubmit() {
            const email = document.getElementById('email').value;
            const newP = document.getElementById('password').value;
            const confP = document.getElementById('confirmPassword').value;

            // Basic password match validation
            if (newP !== confP) {
                alert("Passwords do not match");
                return;
            }

            try {
                const response = await fetch('user/resetpassword', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ email, newP, confP }),
                });

                const data = await response.json();

                // Handle the response from the server
                console.log('Server Response:', data);

                if (response.ok) {
                    alert('Password reset successful');
                    // Redirect to the login page
                    window.location.href = '/login';
                } else {
                    alert('Password reset failed');
                }
            } catch (error) {
                console.error('Error:', error);
                alert('Password reset failed');
            }
        }
    </script>
</body>

</html>
